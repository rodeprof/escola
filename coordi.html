<!doctype html>
<html lang="ca">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Valoració — Coordinador Digital</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#ffcc00;--muted:#98a0b3}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#081226 0%, #071024 100%);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}

    .card{background:linear-gradient(180deg,rgba(255,255,255,0.03), rgba(255,255,255,0.01));padding:36px;border-radius:16px;box-shadow:0 6px 30px rgba(2,6,23,0.6);width:100%;max-width:740px;text-align:center}
    h1{margin:0 0 18px;font-size:1.6rem}
    p.sub{color:var(--muted);margin:0 0 24px}

    .buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    .rate-btn{appearance:none;border:0;background:#0b2340;padding:14px 18px;border-radius:12px;color:var(--accent);font-weight:700;font-size:1rem;cursor:pointer;min-width:56px;transition:transform .18s ease, box-shadow .18s;box-shadow:0 6px 18px rgba(2,6,23,0.5)}
    .rate-btn:hover{transform:translateY(-6px) scale(1.03)}

    .thank-you{font-size:1.4rem;padding:26px}
    .stars{display:flex;gap:8px;justify-content:center;margin-top:14px}
    .star{font-size:1.8rem;filter:drop-shadow(0 6px 10px rgba(0,0,0,0.6))}

    @keyframes fadeUp {0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-36px) scale(.8)}}
    @keyframes slideRight {0%{transform:translateX(0) rotate(0)}100%{transform:translateX(120%) rotate(15deg);opacity:0}}
    @keyframes spinShrink {0%{transform:rotate(0) scale(1)}100%{transform:rotate(540deg) scale(0);opacity:0}}
    @keyframes bounceAway {0%{transform:translateY(0) scale(1)}30%{transform:translateY(-18px) scale(1.08)}100%{transform:translateY(140%) scale(.2);opacity:0}}

    .anim-1{animation:fadeUp .9s cubic-bezier(.2,.9,.3,1) forwards}
    .anim-2{animation:slideRight .85s cubic-bezier(.2,.9,.3,1) forwards}
    .anim-3{animation:spinShrink .95s cubic-bezier(.2,.9,.3,1) forwards}
    .anim-4{animation:bounceAway 1s cubic-bezier(.2,.9,.3,1) forwards}

    .confetti{position:absolute;left:50%;top:0;pointer-events:none;width:8px;height:8px;border-radius:2px;transform:translateX(-50%);opacity:0}
    @keyframes confettiFall {0%{opacity:1;transform:translateY(-12vh) rotate(0) translateX(0)}100%{opacity:1;transform:translateY(80vh) rotate(540deg) translateX(calc(var(--tx,0)*1px))}}

    @keyframes popIn {0%{transform:scale(.8);opacity:0}60%{transform:scale(1.06)}100%{transform:scale(1);opacity:1}}
    .pop{animation:popIn .7s cubic-bezier(.2,.9,.3,1) both}

    @media (max-width:420px){.rate-btn{padding:12px 14px;min-width:48px}}
  </style>
</head>
<body>
  <main class="card" id="card">
    <h1>Com de guay és el vostre coordinador digital?</h1>
    <p class="sub">Valora amb un número de l'1 al 5.</p>

    <div class="buttons" id="buttons" role="radiogroup" aria-label="Puntuació coordinador">
      <button class="rate-btn" data-value="1">1</button>
      <button class="rate-btn" data-value="2">2</button>
      <button class="rate-btn" data-value="3">3</button>
      <button class="rate-btn" data-value="4">4</button>
      <button class="rate-btn" data-value="5">5</button>
    </div>
  </main>

  <script>
    (function(){
      const buttons = document.getElementById('buttons');
      const card = document.getElementById('card');
      const btns = Array.from(buttons.querySelectorAll('.rate-btn'));

      const animMap = { '1':'anim-1', '2':'anim-2', '3':'anim-3', '4':'anim-4' };

      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

      function playSound(type){
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if(type==='error'){
          osc.type='square';
          osc.frequency.setValueAtTime(200 + Math.random()*200, now);
          gain.gain.setValueAtTime(0.2, now);
          gain.gain.exponentialRampToValueAtTime(0.001, now + 0.25);
          osc.start(now);
          osc.stop(now + 0.25);
        } else if(type==='confirm'){
          osc.type='triangle';
          osc.frequency.setValueAtTime(600, now);
          gain.gain.setValueAtTime(0.2, now);
          osc.frequency.exponentialRampToValueAtTime(1000, now + 0.3);
          gain.gain.exponentialRampToValueAtTime(0.001, now + 0.4);
          osc.start(now);
          osc.stop(now + 0.4);
        } else if(type==='applause'){
          for(let i=0;i<80;i++){
            const click = audioCtx.createBufferSource();
            const buffer = audioCtx.createBuffer(1, 220, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for(let j=0;j<data.length;j++) data[j]=(Math.random()*2-1)*Math.pow(1-j/data.length,2);
            click.buffer = buffer;
            const g = audioCtx.createGain();
            g.gain.value = Math.random()*0.1;
            click.connect(g).connect(audioCtx.destination);
            click.start(now + Math.random()*1.2);
          }
        }
      }

      function handleClick(e){
        const btn = e.currentTarget;
        const value = btn.dataset.value;
        btns.forEach(b=>b.disabled = true);

        if(value === '5'){
          playSound('confirm');
          card.innerHTML = `\n            <div class="pop" style="padding:28px">\n              <div class="thank-you">\n                <div style="font-size:1.1rem;font-weight:700">Vosaltres sí que mereixeu 5 estrelles!</div>\n                <div class="stars" aria-hidden="true">\n                  <div class="star">★</div><div class="star">★</div><div class="star">★</div><div class="star">★</div><div class="star">★</div>\n                </div>\n              </div>\n            </div>\n          `;

          for(let i=0;i<18;i++){
            const conf = document.createElement('div');
            conf.className = 'confetti';
            conf.style.background = ['#ffcc00','#ff6b6b','#6bffb8','#80d0ff','#c28bff'][i%5];
            conf.style.setProperty('--tx', (Math.random()*400 - 200).toFixed(2));
            conf.style.left = (50 + (Math.random()*40 - 20)) + '%';
            conf.style.top = (10 + Math.random()*6) + '%';
            conf.style.animation = `confettiFall ${0.9 + Math.random()*1.4}s cubic-bezier(.25,.9,.25,1) forwards`;
            conf.style.zIndex = 2000;
            document.body.appendChild(conf);
            setTimeout(()=>conf.remove(), 2800);
          }
          playSound('applause');

        } else {
          playSound('error');
          const cls = animMap[value];
          btn.classList.add(cls);
          btn.addEventListener('animationend', function onEnd(){
            btn.removeEventListener('animationend', onEnd);
            btn.remove();
            btns.filter(b=>document.body.contains(b)).forEach(b=>b.disabled = false);
          });
        }
      }

      btns.forEach(b=>b.addEventListener('click', handleClick));
      window.addEventListener('keydown', (e)=>{
        if(['1','2','3','4','5'].includes(e.key)){
          const target = btns.find(b=>b.dataset.value===e.key);
          if(target) target.click();
        }
      });
    })();
  </script>
</body>
</html>
