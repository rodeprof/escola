<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ahorcado — Prefijos y Sufijos</title>
<style>
  :root{
    --bg:#f7f8fb; --card:#ffffff; --accent:#2b6cb0; --muted:#666;
  }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:var(--bg); margin:0; padding:24px; color:#222;}
  .wrap{max-width:1000px; margin:0 auto; display:grid; grid-template-columns: 420px 1fr; gap:20px; align-items:start;}
  .card{background:var(--card); border-radius:12px; padding:18px; box-shadow:0 6px 18px rgba(40,40,70,0.06);}
  header{grid-column:1/-1; text-align:center; margin-bottom:8px;}
  h1{margin:6px 0 2px; font-size:20px;}
  p.lead{margin:0;color:var(--muted); font-size:14px;}
  canvas{background:#fff; border-radius:8px; display:block; margin:0 auto;}
  .word{letter-spacing:10px; font-size:34px; text-transform:lowercase; text-align:center; padding:18px 10px;}
  .controls{display:flex; gap:10px; justify-content:space-between; align-items:center; margin-top:8px;}
  .kbd{display:flex; flex-wrap:wrap; gap:6px; justify-content:center;}
  .key{min-width:36px; height:36px; border-radius:8px; display:inline-grid; place-items:center; background:#eef3fb; cursor:pointer; user-select:none; font-weight:600;}
  .key.disabled{opacity:0.38; cursor:default;}
  .info{font-size:14px; color:var(--muted);}
  .toolbar{display:flex; gap:8px; align-items:center;}
  button.btn{background:var(--accent); color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer;}
  button.btn.secondary{background:#e7edf9; color:var(--accent);}
  .stat{font-size:13px; color:var(--muted);}
  .hint{background:#fffbeb; border:1px solid #f5e1a6; padding:8px; border-radius:8px; margin-top:8px; font-weight:600;}
  footer{grid-column:1/-1; text-align:center; margin-top:12px; font-size:13px; color:var(--muted);}
  @media (max-width:820px){ .wrap{grid-template-columns:1fr; padding:0 10px;} canvas{width:260px; height:260px;} }
</style>
</head>
<body>
  <header>
    <h1>Ahorcado — Prefijos y Sufijos</h1>
    <p class="lead">Solo se usan las partículas estudiadas en la actividad (in/im, re, pre, des; -ero/-era, -ista, -oso/-osa, -able/-ible, -ito/-ita, -ón/-ona, -idad, -ción, -al)</p>
  </header>

  <div class="wrap">
    <div class="card">
      <canvas id="lienzo" width="380" height="380" aria-label="Dibujo del ahorcado"></canvas>

      <div class="word" id="displayWord">_ _ _ _ _</div>

      <div class="controls">
        <div>
          <div class="stat">Errores: <span id="wrongCount">0</span>/6</div>
          <div class="stat">Palabra elegida: <strong id="categoria">—</strong></div>
        </div>
        <div class="toolbar">
          <button class="btn" id="nuevoBtn">Nueva palabra</button>
          <button class="btn secondary" id="reintentarBtn">Reiniciar</button>
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="hint" id="hintBox">Pista: —</div>
      </div>
    </div>

    <div class="card">
      <h3 style="margin-top:2px">Letras</h3>
      <p class="info">Haz clic en las letras (incluye la ñ). También puedes usar tu teclado físico.</p>

      <div class="kbd" id="keyboard"></div>

      <div style="margin-top:12px;">
        <strong>Palabras incluidas (ejemplos):</strong>
        <ul id="wordList" style="margin:8px 0 0 18px; color:var(--muted)"></ul>
      </div>
    </div>

    <footer>
      Juego creado a partir de la actividad: <em>Prefijos y sufijos</em>. Las pistas indican el prefijo o sufijo presente en cada palabra.
    </footer>
  </div>

<script>
/* --- Lista de palabras válidas — cada palabra debe contener UNO de los prefijos/sufijos de la actividad --- 
   IMPORTANTE: las palabras se guardan en minúsculas sin tildes para simplificar la comparación.
   Para cumplir la condición del ejercicio, cada entrada indica la partícula usada (prefijo o sufijo).
*/
const WORDS = [
  {word:"infeliz", aff:"prefijo: in-"},
  {word:"imposible", aff:"prefijo: im-"},
  {word:"rehacer", aff:"prefijo: re-"},
  {word:"recargar", aff:"prefijo: re-"},
  {word:"prehistoria", aff:"prefijo: pre-"},
  {word:"desordenar", aff:"prefijo: des-"},
  {word:"desconocido", aff:"prefijo: des-"},
  {word:"panadero", aff:"sufijo: -ero"},
  {word:"jardinera", aff:"sufijo: -era"},
  {word:"artista", aff:"sufijo: -ista"},
  {word:"futbolista", aff:"sufijo: -ista"},
  {word:"cariñoso", aff:"sufijo: -oso"},
  {word:"carinoso", aff:"sufijo: -oso"}, // redundancia para teclados sin ñ
  {word:"ruidosa", aff:"sufijo: -osa"},
  {word:"amable", aff:"sufijo: -able"},
  {word:"legible", aff:"sufijo: -ible"},
  {word:"perrito", aff:"sufijo: -ito"},
  {word:"casita", aff:"sufijo: -ita"},
  {word:"grandullon", aff:"sufijo: -on"},
  {word:"felicidad", aff:"sufijo: -idad"},
  {word:"construible", aff:"sufijo: -ible"},
  {word:"construccion", aff:"sufijo: -cion"},
  {word:"rosal", aff:"sufijo: -al"}
];

/* --- UI elementos --- */
const canvas = document.getElementById('lienzo');
const ctx = canvas.getContext('2d');
const displayWord = document.getElementById('displayWord');
const keyboardDiv = document.getElementById('keyboard');
const wrongCountSpan = document.getElementById('wrongCount');
const hintBox = document.getElementById('hintBox');
const nuevoBtn = document.getElementById('nuevoBtn');
const reintentarBtn = document.getElementById('reintentarBtn');
const categoriaSpan = document.getElementById('categoria');
const wordListEl = document.getElementById('wordList');

let secret = "";
let normalizedSecret = "";
let revealed = [];
let wrongs = 0;
const MAX_WRONGS = 6;
let usedLetters = new Set();

/* --- teclado: letras españolas incl. ñ --- */
const LETTERS = "abcdefghijklmnñopqrstuvwxyz".split('');

function populateWordList(){
  WORDS.forEach(w=>{
    const li = document.createElement('li');
    li.textContent = `${w.word}  —  ${w.aff}`;
    wordListEl.appendChild(li);
  });
}
populateWordList();

/* --- util normalizar: quitar tildes para comparar, mantener ñ --- */
function normalizeWord(s){
  // reemplaza tildes pero conserva ñ
  const map = {'á':'a','é':'e','í':'i','ó':'o','ú':'u','Á':'A','É':'E','Í':'I','Ó':'O','Ú':'U'};
  return s.split('').map(ch => map[ch] || ch).join('').toLowerCase();
}

/* --- inicializar teclado --- */
function createKeyboard(){
  keyboardDiv.innerHTML = "";
  LETTERS.forEach(l=>{
    const b = document.createElement('div');
    b.className = 'key';
    b.textContent = l;
    b.dataset.letter = l;
    b.addEventListener('click', ()=> tryLetter(l));
    keyboardDiv.appendChild(b);
  });
}
createKeyboard();

/* --- dibujar horca y persona según errores --- */
function drawGallows(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.lineWidth = 6;
  ctx.strokeStyle = "#222";
  // base
  ctx.beginPath();
  ctx.moveTo(40,340); ctx.lineTo(200,340); ctx.stroke();
  // poste
  ctx.beginPath();
  ctx.moveTo(80,340); ctx.lineTo(80,40); ctx.lineTo(240,40); ctx.lineTo(240,80); ctx.stroke();
}
function drawMan(stage){
  ctx.lineWidth = 5;
  ctx.strokeStyle = "#222";
  ctx.fillStyle = "#222";
  if(stage >= 1){
    // cabeza
    ctx.beginPath();
    ctx.arc(240,110,30,0,Math.PI*2); ctx.stroke();
  }
  if(stage >= 2){
    // cuerpo
    ctx.beginPath();
    ctx.moveTo(240,140); ctx.lineTo(240,230); ctx.stroke();
  }
  if(stage >= 3){
    // brazo izquierdo
    ctx.beginPath(); ctx.moveTo(240,160); ctx.lineTo(200,200); ctx.stroke();
  }
  if(stage >= 4){
    // brazo derecho
    ctx.beginPath(); ctx.moveTo(240,160); ctx.lineTo(280,200); ctx.stroke();
  }
  if(stage >= 5){
    // pierna izquierda
    ctx.beginPath(); ctx.moveTo(240,230); ctx.lineTo(210,290); ctx.stroke();
  }
  if(stage >= 6){
    // pierna derecha
    ctx.beginPath(); ctx.moveTo(240,230); ctx.lineTo(270,290); ctx.stroke();
  }
}

/* --- seleccionar palabra aleatoria --- */
function pickWord(){
  const idx = Math.floor(Math.random()*WORDS.length);
  return WORDS[idx];
}

/* --- iniciar juego --- */
function startGame(newWord=true){
  usedLetters.clear();
  wrongs = 0;
  wrongCountSpan.textContent = wrongs;
  enableAllKeys();
  drawGallows();
  drawMan(0);

  let pick = (newWord) ? pickWord() : WORDS.find(w => normalizeWord(w.word) === normalizedSecret) || pickWord();
  secret = pick.word;
  normalizedSecret = normalizeWord(secret);
  // revealed: array of chars or '_'
  revealed = normalizedSecret.split('').map(ch => (ch.match(/[a-zñ]/i) ? '_' : ch));
  updateDisplay();
  hintBox.textContent = "Pista: " + pick.aff;
  categoriaSpan.textContent = "contiene " + pick.aff;
}

/* --- actualizar display de la palabra --- */
function updateDisplay(){
  displayWord.textContent = revealed.join(' ');
}

/* --- manejar intento de letra --- */
function tryLetter(letter){
  if(wrongs >= MAX_WRONGS) return;
  letter = letter.toLowerCase();
  if(usedLetters.has(letter)) return;
  usedLetters.add(letter);
  // deshabilitar tecla
  const keys = document.querySelectorAll('.key');
  keys.forEach(k => { if(k.dataset.letter === letter) k.classList.add('disabled'); });

  // normalizar la letra en comparación (si usuario pulsa 'n' y palabra contiene 'ñ' no son iguales)
  // We treat 'ñ' distinct. Use normalizedSecret which preserves ñ.
  let matched = false;
  for(let i=0;i<normalizedSecret.length;i++){
    if(normalizedSecret[i] === letter){
      revealed[i] = secret[i]; // use original secret char to preserve ñ and posibles letras
      matched = true;
    }
  }
  if(matched){
    updateDisplay();
    checkWin();
  } else {
    wrongs++;
    wrongCountSpan.textContent = wrongs;
    drawGallows();
    drawMan(wrongs);
    if(wrongs >= MAX_WRONGS) endGame(false);
  }
}

/* --- chequear victoria --- */
function checkWin(){
  if(!revealed.includes('_')) endGame(true);
}

/* --- bloquear/activar teclado --- */
function disableAllKeys(){
  document.querySelectorAll('.key').forEach(k => k.classList.add('disabled'));
}
function enableAllKeys(){
  document.querySelectorAll('.key').forEach(k => k.classList.remove('disabled'));
}

/* --- terminar juego --- */
function endGame(win){
  if(win){
    hintBox.textContent = "¡GANASTE! La palabra era: " + secret + " — " + getAffFor(secret);
    disableAllKeys();
  } else {
    hintBox.textContent = "¡FIN! Se agotaron los intentos. La palabra era: " + secret + " — " + getAffFor(secret);
    // revelar palabra
    revealed = secret.split('');
    updateDisplay();
    disableAllKeys();
  }
}

/* --- buscar aff para pista si es necesario --- */
function getAffFor(w){
  const entry = WORDS.find(x => x.word === w);
  return entry ? entry.aff : "—";
}

/* --- manejo tecla física --- */
window.addEventListener('keydown', (e)=>{
  const key = e.key.toLowerCase();
  if(key.length === 1 && (key >= 'a' && key <= 'z' || key === 'ñ')) {
    tryLetter(key);
  }
});

/* --- botones UI --- */
nuevoBtn.addEventListener('click', ()=> startGame(true));
reintentarBtn.addEventListener('click', ()=> startGame(false));

/* --- iniciar por primera vez --- */
startGame(true);

</script>
</body>
</html>
